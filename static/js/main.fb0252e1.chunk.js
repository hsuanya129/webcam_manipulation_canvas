(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(8),c=a.n(i),o=(a(15),a(1)),s=a(2),l=a(4),m=a(3),u=a(5),d=(a(7),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).videoSwitch=function(){!0===a.stream.active?a.endStream():a.startStream()},a.endStream=function(){a.videoTracks[0].stop(),a.stream.removeTrack(a.videoTracks[0]),a.camVideo.current.srcObject=null,a.setState({streamState:!1})},a.startStream=function(){a.getVideoDevices()},a.getVideoDevices=function(){navigator.mediaDevices.enumerateDevices().then(function(e){a.videoDevices=e.filter(function(e){return"videoinput"===e.kind}),a.getUserMedia()}).catch(function(e){a.setState({errorMsg:"Error message: "+(e.message?e.message:e.name)})})},a.getUserMedia=function(){navigator.mediaDevices.getUserMedia(a.constraints).then(function(e){a.stream=e,a.videoTracks=e.getVideoTracks(),a.camVideo.current.srcObject=e,a.setState({streamState:!0}),a.processor()}).catch(function(e){a.setState({errorMsg:"Error message: "+(e.message?e.message:e.name)})})},a.cameraSwitch=function(){a.constraints.video.deviceId={exact:a.cameraSelect.current.value},a.endStream(),a.startStream()},a.videoEffect=function(e){a.effectType=e.target.value,"grayscale"===e.target.value?a.grayScale():"blur"===e.target.value?a.blur():a.original()},a.processor=function(){console.log(a.c1.current.getContext("2d")),a.context=a.c1.current.getContext("2d"),a.effectType="original",a.camVideo.current.addEventListener("play",function(){a.original(),a.height=a.camVideo.current.videoHeight,a.width=a.camVideo.current.videoWidth,a.c1.current.width=a.width,a.c1.current.height=a.height},!1)},a.original=function(){console.log(a.effectType),a.camVideo.current.ended||!1===a.state.streamState||"original"!==a.effectType||(a.context.drawImage(a.camVideo.current,0,0,a.width,a.height),setTimeout(function(){a.original()},30))},a.grayScale=function(){if(console.log(a.effectType),!a.camVideo.current.ended&&!1!==a.state.streamState&&"grayscale"===a.effectType){a.context.drawImage(a.camVideo.current,0,0,a.width,a.height);for(var e=a.context.getImageData(0,0,a.width,a.height),t=e.data,r=4*a.width,n=a.height,i=0;i<n;i++)for(var c=0;c<r;c+=4){var o=.3*t[i*r+c]+.59*t[i*r+c+1]+.11*t[i*r+c+2];t[i*r+c]=o,t[i*r+c+1]=o,t[i*r+c+2]=o}a.context.putImageData(e,0,0),setTimeout(function(){a.grayScale()},0)}},a.blur=function(){if(!a.camVideo.current.ended&&!1!==a.state.streamState&&"blur"===a.effectType){a.context.drawImage(a.camVideo.current,0,0,a.width,a.height);for(var e=a.context.getImageData(0,0,a.width,a.height),t=e.data,r=4*a.width,n=a.height,i=0;i<n;i++)for(var c,o,s,l=0;l<=r;l+=4)i%12!==0&&l%48!==0||(t[i*r+l+3]=128,l%48===0&&(c=t[i*r+l],o=t[i*r+l+1],s=t[i*r+l+2])),t[i*r+l]=c,t[i*r+l+1]=o,t[i*r+l+2]=s,t[i*r+l+3]=250;a.context.putImageData(e,0,0),setTimeout(function(){a.blur()},0)}},a.saveFrame=function(){console.log("save")},a.state={errorMsg:"",streamState:!0},a.camVideo=n.a.createRef(),a.cameraSelect=n.a.createRef(),a.c1=n.a.createRef(),a.c2=n.a.createRef(),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.constraints={audio:!1,video:{width:{min:640,ideal:1920,max:1920},height:{min:400,ideal:1080,max:1080},aspectRatio:1.777777778}},this.startStream()}},{key:"render",value:function(){var e,t=this;return console.log("render"),this.videoTracks&&(e=this.videoDevices.map(function(e){return n.a.createElement("option",{key:e.deviceId,value:e.deviceId,selected:t.videoTracks[0].label===e.label},e.label)})),n.a.createElement("div",null,this.state.errorMsg?n.a.createElement("p",null," ",this.state.errorMsg," "):n.a.createElement("div",null,n.a.createElement("video",{controls:!0,className:"webcam",ref:this.camVideo,autoPlay:!0,playsInline:!0,hidden:!0}),n.a.createElement("br",null),n.a.createElement("button",{onClick:this.startStream,hidden:this.state.streamState},"create stream"),n.a.createElement("button",{onClick:this.endStream,hidden:!this.state.streamState},"release stream"),n.a.createElement("select",{ref:this.cameraSelect,onChange:this.cameraSwitch},e),n.a.createElement("br",null),this.state.streamState?n.a.createElement("div",null,n.a.createElement("canvas",{className:"c1",ref:this.c1,width:this.width,height:this.height}),n.a.createElement("br",null),n.a.createElement("select",{onChange:this.videoEffect,defaultValue:"original"},n.a.createElement("option",{value:"original"},"Original"),n.a.createElement("option",{value:"grayscale"},"Grayscale"),n.a.createElement("option",{value:"blur"},"Blur")),n.a.createElement("button",{onClick:this.saveFrame}," Save ")):n.a.createElement("p",null," Create stream first ")))}}]),t}(n.a.Component)),h=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement(d,null))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(h,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},7:function(e,t,a){},9:function(e,t,a){e.exports=a(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.fb0252e1.chunk.js.map